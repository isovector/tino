#!/usr/bin/env zsh

new() { jj new -B cap -m "$*" }
desc() { jj describe -m "$*" }

myrofi() {
  rofi -dmenu -i -location 0 -no-fixed-num-lines $*
}

case "$1" in
  new)
    MSG=$(myrofi -dmenu -i -location 0 -p "New Change")
    if (( $? == 0 )); then
      new "$MSG"
    fi
    ;;

  describe)
    MSG=$(jj log -r '@' -T '"$"++description.remove_suffix("\n").first_line()' | cut -d'$' -f2 | head -n1 | myrofi -dmenu -i -location 0 -p "Describe")
    if (( $? == 0 )); then
      desc "$MSG"
    fi
    ;;
esac
