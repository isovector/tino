#!/usr/bin/env zsh

if (( $# != 0 )); then
  jj edit $*
else
  REVS=$(jj log -T 'description.remove_suffix("\n").first_line()++" $"++change_id.shortest()')
  ACTIVE=$(echo $REVS | awk '/@/{ print NR-1; exit }')
  REV=$(echo $REVS | rofi -dmenu -selected-row $ACTIVE -a $ACTIVE)
  if (( $? == 0 )); then
    jj edit $(echo $REV | cut -d'$' -f2)
  fi
fi

